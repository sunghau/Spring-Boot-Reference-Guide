### 65.8. 自定義ViewResolvers

ViewResolver是Spring MVC的核心組件，它負責轉換`@Controller`中的視圖名稱到實際的View實現。注意ViewResolvers主要用在UI應用中，而不是REST風格的服務（View不是用來渲染`@ResponseBody`的）。Spring有很多你可以選擇的ViewResolver實現，並且Spring自己對如何選擇相應實現也沒發表意見。另一方麵，Spring Boot會根據classpath上的依賴和應用上下文為你安裝一或兩個ViewResolver實現。DispatcherServlet使用所有在應用上下文中找到的解析器（resolvers），並依次嘗試每一個直到它獲取到結果，所以如果你正在添加自己的解析器，那就要小心順序和你的解析器添加的位置。

WebMvcAutoConfiguration將會為你的上下文添加以下ViewResolvers：

- bean id為`defaultViewResolver`的InternalResourceViewResolver。這個會定位可以使用DefaultServlet渲染的物理資源（比如，靜態資源和JSP頁麵）。它在視圖（view name）上應用了一個前綴和後綴（默認都為空，但你可以通過`spring.view.prefix`和`spring.view.suffix`外部配置設置），然後查找在servlet上下文中具有該路徑的物理資源。可以通過提供相同類型的bean覆蓋它。
- id為`beanNameViewResolver`的BeanNameViewResolver。這是視圖解析器鏈的一個非常有用的成員，它可以在View被解析時收集任何具有相同名稱的beans。
- id為`viewResolver`的ContentNegotiatingViewResolver隻會在實際View類型的beans出現時添加。這是一個'主'解析器，它的職責會代理給其他解析器，它會嘗試找到客戶端發送的一個匹配'Accept'的HTTP頭部。這有一篇有用的，關於你需要更多了解的[ContentNegotiatingViewResolver](https://spring.io/blog/2013/06/03/content-negotiation-using-views)的博客，也要具體查看下源碼。通過定義一個名叫'viewResolver'的bean，你可以關閉自動配置的ContentNegotiatingViewResolver。
- 如果使用Thymeleaf，你將有一個id為`thymeleafViewResolver`的ThymeleafViewResolver。它會通過加前綴和後綴的視圖名來查找資源（外部配置為`spring.thymeleaf.prefix`和`spring.thymeleaf.suffix`，對應的默認為'classpath:/templates/'和'.html'）。你可以通過提供相同名稱的bean來覆蓋它。
- 如果使用FreeMarker，你將有一個id為`freeMarkerViewResolver`的FreeMarkerViewResolver。它會使用加前綴和後綴（外部配置為`spring.freemarker.prefix`和`spring.freemarker.suffix`，對應的默認值為空和'.ftl'）的視圖名從加載路徑（外部配置為`spring.freemarker.templateLoaderPath`，默認為'classpath:/templates/'）下查找資源。你可以通過提供一個相同名稱的bean來覆蓋它。
- 如果使用Groovy模板（實際上隻要你把groovy-templates添加到classpath下），你將有一個id為`groovyTemplateViewResolver`的Groovy TemplateViewResolver。它會使用加前綴和後綴（外部屬性為`spring.groovy.template.prefix`和`spring.groovy.template.suffix`，對應的默認值為'classpath:/templates/'和'.tpl'）的視圖名從加載路徑下查找資源。你可以通過提供一個相同名稱的bean來覆蓋它。
- 如果使用Velocity，你將有一個id為`velocityViewResolver`的VelocityViewResolver。它會使用加前綴和後綴（外部屬性為`spring.velocity.prefix`和`spring.velocity.suffix`，對應的默認值為空和'.vm'）的視圖名從加載路徑（外部屬性為`spring.velocity.resourceLoaderPath`，默認為'classpath:/templates/'）下查找資源。你可以通過提供一個相同名稱的bean來覆蓋它。

具體參考：  [WebMvcAutoConfiguration](http://github.com/spring-projects/spring-boot/tree/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/WebMvcAutoConfiguration.java)，[ThymeleafAutoConfiguration](http://github.com/spring-projects/spring-boot/tree/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/thymeleaf/ThymeleafAutoConfiguration.java)，[FreeMarkerAutoConfiguration](http://github.com/spring-projects/spring-boot/tree/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/thymeleaf/ThymeleafAutoConfiguration.java)，[GroovyTemplateAutoConfiguration](http://github.com/spring-projects/spring-boot/tree/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/thymeleaf/ThymeleafAutoConfiguration.java)，[VelocityAutoConfiguration](http://github.com/spring-projects/spring-boot/tree/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/thymeleaf/ThymeleafAutoConfiguration.java)。
